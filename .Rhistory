bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
knitr::include_graphics("figs/myfig1111.png")
knitr::include_graphics("1111.png")
knitr::include_graphics("figs/1112.png")
knitr::include_graphics("figs/1111.png")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
thedata<-data.frame(x=rnorm(20),f=rep(c("level1","level2"),10))
thedata$y<-rnorm(20,,3)+thedata$x*(as.numeric(thedata$f)-1)
library(effects)
install.packages("effects")
install.packages("effects")
thedata<-data.frame(x=rnorm(20),f=rep(c("level1","level2"),10))
thedata$y<-rnorm(20,,3)+thedata$x*(as.numeric(thedata$f)-1)
library(effects)
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "pdf", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::pdf_book", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::pdf_book", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::pdf_book", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::pdf_book", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::pdf_book", encoding = "UTF-8")
---
title: "管理学统计分析快速上手指南"
author: "曹伟"
date: "`r Sys.Date()`"
description: "这是用R的bookdown功能制作中文图书，输出格式为bookdown::gitbook和bookdown::pdf_book."
documentclass: book
biblio-style: apa
bibliography: [mybib.bib]
link-citations: yes
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# 简介 {-}
本书涵盖管理学(特别是微观管理)研究中常用的方法，诸如问卷调查分析方法、实验法、元分析等。适用于研究生、科研人员以及对管理学研究方法感兴趣的读者。
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::pdf_book", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::pdf_book", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
setwd("C:/Users/ASUS/Desktop/PL Bib")
library(bibliometrix)
biblioshiny()
biblioshiny()
setwd("C:/Users/ASUS/Desktop/PL Bib")
library(bibliometrix)
biblioshiny()
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
setwd("C:/Users/ASUS/Desktop")
#设置分析的工作目录
setwd("C:/Users/ASUS/Desktop/meta data")
#读取数据
dat <- read.csv("dat_pls.csv", header=TRUE)
View(dat)
#加载相应R包
library("robumeta")
library("metafor")
library("dplyr")
#读取数据
dat <- read.csv("dat_pls.csv", header=TRUE)
View(dat)
#加载相应R包
library("robumeta")
library("metafor")
library("dplyr")
dat_rAM <- escalc(measure="ZCOR", ri=rAM, ni=n, data=dat_pls,
slab=paste(authors, year, sep=", "))
#读取数据
dat_pls <- read.csv("dat_pls.csv", header=TRUE)
View(dat_pls)
dat_rAM <- escalc(measure="ZCOR", ri=rAM, ni=n, data=dat_pls,
slab=paste(authors, year, sep=", "))
View(dat_rAM)
View(dat_rAM)
######随机效应模型估计######
res <- rma(yi, vi, data=dat_rAM, method="REML")
#查看结果
res
#查看异质性的估计量95%置信区间
confint(res)
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
######固定效应模型估计######
fes <- rma(yi, vi, data=dat, method="FE")
######固定效应模型估计######
fes <- rma(yi, vi, data=dat_rAM, method="FE")
fes
predict(fes, digits=4, transf=transf.ztor)
#利用Bajaut plot可视化异质性结果，查看哪些研究具有较大的异质性
#根据study_id进行标记
b_res <- rma(yi, vi, data=dat_rAM, slab=study_id)
baujat(b_res)
######通过FisherZ转换 将r变为Z(yi) 并计算其方差(vi)######
#ri: vector to specify the raw correlation coefficients
#ni: vector to specify the sample/group sizes
#slab: optional vector with labels for the studies.
dat_rAM <- escalc(measure="ZCOR", ri=rAM, ni=n, data=dat_pls,
slab=paste(authors, year, sep=", "))
#利用forest plot可视化元分析的影响大小
#xlim: 图形水平方向的限制
#atransf:
#at: 横轴坐标及标签定义参数
#digits:保留估计值和置信区间数值3位小数 刻度线1位小数
#cex:
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
#美化一下森林图
text(-1.6, 18, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 18, "Correlation [95% CI]", pos=2, cex=.8)
funnel(res, xlab = "Correlation coefficient")
#利用统计方法检查是否存在出版偏倚
regtest(res)    #Egger线性回归验
ranktest(res)   #Begg秩相关检验
#失安全系数 默认为Rosenthal
#表明还需要纳入210项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=dat, type="Rosenberg")
#失安全系数 默认为Rosenthal
#表明还需要纳入210项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=dat_rAM, type="Rosenberg")
#运用剪补法填补缺失值，去生成对称的漏斗图
res.tf <- trimfill(res)
res.tf
funnel(res.tf, xlab = "Correlation coefficient")
funnel(res.tf, xlab = "Correlation coefficient")
#设置分析的工作目录
setwd("C:/Users/ASUS/Desktop/pls data")
#设置分析的工作目录
setwd("C:/Users/ASUS/Desktop/pls data")
setwd("C:/Users/ASUS/Desktop/pls data")
setwd("C:/Users/ASUS/Desktop/pls data")
setwd("C:/Users/ASUS/Desktop/pls meta")
#读取数据
data_pls <- read.csv("data_pls.csv", header=TRUE)
#加载相应R包
library("robumeta")
library("metafor")
library("dplyr")
data_rAM <- escalc(measure="ZCOR", ri=rAM, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rAM)
######随机效应模型估计######
res <- rma(yi, vi, data=data_rAM, method="REML")
#查看结果
res
#查看异质性的估计量95%置信区间
confint(res)
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
######固定效应模型估计######
fes <- rma(yi, vi, data=data_rAM, method="FE")
fes
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
text(-1.6, 18, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 18, "Correlation [95% CI]", pos=2, cex=.8)
#美化一下森林图
text(-1.6, 36, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 18, "Correlation [95% CI]", pos=2, cex=.8)
#美化一下森林图
text(-1.6, 26, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 18, "Correlation [95% CI]", pos=2, cex=.8)
#美化一下森林图
text(-1.6, 32, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 18, "Correlation [95% CI]", pos=2, cex=.8)
#美化一下森林图
text(-1.6, 34, "Author(s), Year", pos=4, cex=.8)
#美化一下森林图
text(-1.6, 33, "Author(s), Year", pos=4, cex=.8)
#美化一下森林图
text(-1.6, 32.5, "Author(s), Year", pos=4, cex=.8)
#利用forest plot可视化元分析的影响大小
#xlim: 图形水平方向的限制
#atransf:
#at: 横轴坐标及标签定义参数
#digits:保留估计值和置信区间数值3位小数 刻度线1位小数
#cex:
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
#美化一下森林图
text(-1.6, 32.5, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 32.5, "Correlation [95% CI]", pos=2, cex=.8)
#利用forest plot可视化元分析的影响大小
#xlim: 图形水平方向的限制
#atransf:
#at: 横轴坐标及标签定义参数
#digits:保留估计值和置信区间数值3位小数 刻度线1位小数
#cex:
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
#美化一下森林图
text(-1.6, 33, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 33, "Correlation [95% CI]", pos=2, cex=.8)
#利用统计方法检查是否存在出版偏倚
regtest(res)    #Egger线性回归验
ranktest(res)   #Begg秩相关检验
#失安全系数 默认为Rosenthal
#表明还需要纳入210项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=data_rAM, type="Rosenberg")
# 3 分类变量 measure
#元回归模型
res.mes <- rma(yi, vi, mods = ~ factor(measure), data=dat)
# 3 分类变量 measure
#元回归模型
res.mes <- rma(yi, vi, mods = ~ factor(measure), data=data_rAM)
res.mes
#亚组分析
res.mesother <- rma(yi, vi, data=data_rAM, subset=(controls=="other"))
res.mesother <- rma(yi, vi, data=data_rAM, subset=(measure=="other"))
res.meszheng2000 <- rma(yi, vi, data=data_rAM, subset=(measure=="zheng2000"))
res.meszheng2003 <- rma(yi, vi, data=data_rAM, subset=(measure=="zheng2003"))
res.mes <- rma(yi, vi, mods = ~ factor(measure)-1, data=data_rAM)
res.mes
data_rAB <- escalc(measure="ZCOR", ri=rAB, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rAB)
######随机效应模型估计######
res <- rma(yi, vi, data=data_rAB, method="REML")
#查看结果
res
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
text(-1.6, 33, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 33, "Correlation [95% CI]", pos=2, cex=.8)
#失安全系数 默认为Rosenthal
#表明还需要纳入7121项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=data_rAM, type="Rosenberg")
#失安全系数 默认为Rosenthal
#表明还需要纳入7121项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=data_rAB, type="Rosenberg")
#调节效应分析(使用亚组比较分析)
#分类变量 measure
#元回归模型
res.mes <- rma(yi, vi, mods = ~ factor(measure), data=data_rAB)
res.mes
#亚组分析
res.mes <- rma(yi, vi, mods = ~ factor(measure)-1, data=data_rAM)
res.mes
#亚组分析
res.mes <- rma(yi, vi, mods = ~ factor(measure)-1, data=data_rAB)
res.mes
#调节效应分析(使用亚组比较分析)
#分类变量 measure
#元回归模型
res.mes <- rma(yi, vi, mods = ~ factor(measure), data=data_rAB)
res.mes
#亚组分析
res.mes <- rma(yi, vi, mods = ~ factor(measure)-1, data=data_rAB)
res.mes
data_rMB <- escalc(measure="ZCOR", ri=rMB, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rMB)
######随机效应模型估计######
res <- rma(yi, vi, data=data_rMB, method="REML")
#查看结果
res
#查看异质性的估计量95%置信区间
confint(res)
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
#美化一下森林图
text(-1.6, 33, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 33, "Correlation [95% CI]", pos=2, cex=.8)
#失安全系数 默认为Rosenthal
#表明还需要纳入3498项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=data_rMB, type="Rosenberg")
#调节效应分析(使用亚组比较分析)
#分类变量 measure
#元回归模型
res.mes <- rma(yi, vi, mods = ~ factor(measure), data=data_rMB)
res.mes
#亚组分析
res.mes <- rma(yi, vi, mods = ~ factor(measure)-1, data=data_rAB)
res.mes
#设置分析的工作目录
setwd("C:/Users/ASUS/Desktop/pls meta")
#读取数据
data_pls <- read.csv("data_pls.csv", header=TRUE)
#加载相应R包
library("robumeta")
library("metafor")
library("dplyr")
######通过FisherZ转换 将r变为Z(yi) 并计算其方差(vi)######
data_rAB <- escalc(measure="ZCOR", ri=rAB, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rAB)
######随机效应模型估计######
res <- rma(yi, vi, data=data_rAB, method="REML")
#查看结果
res
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
#美化一下森林图
text(-1.6, 33, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 33, "Correlation [95% CI]", pos=2, cex=.8)
fsn(yi, vi, data=data_rAM, type="Rosenberg")
data_rAM <- escalc(measure="ZCOR", ri=rAB, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rAM)
#设置分析的工作目录
setwd("C:/Users/ASUS/Desktop/pls meta")
#读取数据
data_pls <- read.csv("data_pls.csv", header=TRUE)
data_rAM <- escalc(measure="ZCOR", ri=rAM, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rAM)
######随机效应模型估计######
res <- rma(yi, vi, data=data_rAM, method="REML")
#查看结果
res
#查看异质性的估计量95%置信区间
confint(res)
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
#美化一下森林图
text(-1.6, 33, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 33, "Correlation [95% CI]", pos=2, cex=.8)
#失安全系数 默认为Rosenthal
#表明还需要纳入7121项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=data_rAM, type="Rosenberg")
######通过FisherZ转换 将r变为Z(yi) 并计算其方差(vi)######
#ri: vector to specify the raw correlation coefficients
#ni: vector to specify the sample/group sizes
#slab: optional vector with labels for the studies.
data_rAB <- escalc(measure="ZCOR", ri=rAB, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rAB)
######随机效应模型估计######
res <- rma(yi, vi, data=data_rAB, method="REML")
#查看结果
res
#查看异质性的估计量95%置信区间
confint(res)
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
text(-1.6, 33, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 33, "Correlation [95% CI]", pos=2, cex=.8)
#失安全系数 默认为Rosenthal
#表明还需要纳入3498项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=data_rAB, type="Rosenberg")
######通过FisherZ转换 将r变为Z(yi) 并计算其方差(vi)######
#ri: vector to specify the raw correlation coefficients
#ni: vector to specify the sample/group sizes
#slab: optional vector with labels for the studies.
data_rMB <- escalc(measure="ZCOR", ri=rMB, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rMB)
######随机效应模型估计######
res <- rma(yi, vi, data=data_rMB, method="REML")
#查看结果
res
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
#利用forest plot可视化元分析的影响大小
#xlim: 图形水平方向的限制
#atransf:
#at: 横轴坐标及标签定义参数
#digits:保留估计值和置信区间数值3位小数 刻度线1位小数
#cex:
forest(res, xlim=c(-1.6,1.6), atransf=transf.ztor,
at=transf.rtoz(c(-.4,-.2,0,.2,.4,.6)), digits=c(3,1), cex=.8)
text(-1.6, 33, "Author(s), Year", pos=4, cex=.8)
text( 1.6, 33, "Correlation [95% CI]", pos=2, cex=.8)
#失安全系数 默认为Rosenthal
#表明还需要纳入54810项研究才会使结果变得不显著，该值远大于纳入的研究数量，
#因此可以认为不存在发表偏倚，或即使存在发表偏倚，对本研究结果的影响也较小
fsn(yi, vi, data=data_rMB, type="Rosenberg")
#设置分析的工作目录
setwd("C:/Users/ASUS/Desktop/pls meta")
#读取数据
data_pls <- read.csv("data_pls.csv", header=TRUE)
#加载相应R包
library("robumeta")
library("metafor")
library("dplyr")
View(data_pls)
######通过FisherZ转换 将r变为Z(yi) 并计算其方差(vi)######
data_rAM <- escalc(measure="ZCOR", ri=rAM, ni=n, data=data_pls,
slab=paste(authors, year, sep=", "))
#查看转化后的数据
View(data_rAM)
######随机效应模型估计######
res <- rma(yi, vi, data=data_rAM, method="REML")
#查看结果
#查看结果
res
#总体的平均加权后的相关系数
predict(res, digits=4, transf=transf.ztor)
#查看转化后的数据
View(data_rAM)
library(installr)
updateR()
updateR()
install.packages("process")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
bookdown::render_book("index.Rmd",output_format = "bookdown::gitbook", encoding = "UTF-8")
